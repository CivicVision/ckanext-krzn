{% extends "header.html" %}

{% set pkg = c.pkg_dict %}

{#
Remove "Organization" from breadcrumb
#}

{% block breadcrumb_content_selected %} class="active"{% endblock %}

{% block breadcrumb_content %}
  {% if pkg %}
    {% set dataset = pkg.title or pkg.name %}
    {% if pkg.organization %}
      {% set organization = pkg.organization.title or pkg.organization.name %}
      <li>{% link_for organization|truncate(30), controller='organization', action='read', id=pkg.organization.name %}</li>
    {% else %}
      <li>{% link_for _('Datasets'), controller='package', action='search' %}</li>
    {% endif %}
    <li{{ self.breadcrumb_content_selected() }}>{% link_for dataset|truncate(30), controller='package', action='read', id=pkg.name %}</li>
  {% else %}
    <li>{% link_for _('Datasets'), controller='package', action='search' %}</li>
    <li class="active"><a href="">{{ _('Create Dataset') }}</a></li>
  {% endif %}
{% endblock %}

{#
Use site navigation for organization instead of global one
#}
{% block header_site_navigation_tabs %}
  {{ h.build_nav('organization_read', _('Datasets'), id=mandant.name) }}
  {{ h.build_nav('organization_activity', _('Activity Stream'), id=mandant.name) }}
  {{ h.build_nav('organization_about', _('About'), id=mandant.name) }}
{% endblock %}

{% block header_logo %}
  {% if mandant %}
    {% set url=h.url_for(controller='organization', action='read', id=mandant.name) %}
    <a class="logo" href="{{ url }}"><img src="{{ mandant.image_url or h.url_for_static('/base/images/placeholder-organization.png') }}" alt="{{ mandant.title }} Logo" /></a>
  {% else %}
    {{ super() }}
  {% endif %}
{% endblock %}

{#
Search in organization instead of globally
#}
{% block header_site_search %}
  <form class="section site-search simple-input" action={{ h.url(controller='organization', action='read', id=pkg.organization.name) }} method="get">
    <div class="field">
      <label for="field-sitewide-search">{{ _('Search Datasets') }}</label>
      <input id="field-sitewide-search" type="text" name="q" placeholder="{{ _('Search') }}" />
      <button class="btn-search" type="submit">{{ _('Search') }}</button>
    </div>
  </form>
{% endblock %}
